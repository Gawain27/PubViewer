<form id="graph-form" method="POST" action="/generate-graph" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; align-items: center;">
    <div class="form-group" style="width: 100%;">
        <label for="node-label" style="font-weight: bold; margin-bottom: 5px; display: block;">Start Node Label:</label>
        <div id="node-label-container">
            <input type="text" id="node-label-filter" placeholder="Filter options..." oninput="filterOptions()" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; width: 100%;">
            <select id="node-label" name="node_label" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; width: 100%; margin-top: 5px;">
                <script>
                    (function populateNodeLabels() {
                        const startIds = "{{ start_id }}".split(',');
                        const startLabels = "{{ start_label }}".split(',');
                        const nodeLabelSelector = document.getElementById('node-label');
                        for (let i = 0; i < startIds.length; i++) {
                            const option = document.createElement('option');
                            option.value = startIds[i].trim();
                            option.textContent = startLabels[i].trim();
                            if (i === 0) {
                                option.setAttribute('selected', 'selected'); // Set the first option as selected
                            }
                            nodeLabelSelector.appendChild(option);
                        }
                    })();
                </script>
            </select>
        </div>
    </div>


    <div class="form-group" style="width: 100%;">
        <label for="depth" style="font-weight: bold; margin-bottom: 5px; display: block;">Depth:</label>
        <select id="depth" name="depth" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; width: 100%;">
            <script>
                (function populateDepthOptions() {
                    const depthSelector = document.getElementById('depth');
                    const N = parseInt('{{ max_depth }}', 10);
                    for (let i = 1; i <= N; i++) {
                        const option = document.createElement('option');
                        option.value = i;
                        option.textContent = i;
                        depthSelector.appendChild(option);
                    }
                    depthSelector.value = "1";
                })();
            </script>
        </select>
    </div>

    <div class="form-group" style="width: 100%;">
        <label for="conference-rank" style="font-weight: bold; margin-bottom: 5px; display: block;">Conference Rank:</label>
        <select id="conference-rank" name="conference_rank" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; width: 100%;">
            <option value="" selected>Any</option>
            <option value="A*">A*</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="Unranked">Unranked</option>
        </select>
    </div>

    <div class="form-group" style="width: 100%;">
        <label for="journal-rank" style="font-weight: bold; margin-bottom: 5px; display: block;">Journal Rank:</label>
        <select id="journal-rank" name="journal_rank" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; width: 100%;">
            <option value="" selected>Any</option>
            <option value="Q1">Q1</option>
            <option value="Q2">Q2</option>
            <option value="Q3">Q3</option>
            <option value="Q4">Q4</option>
            <option value="Unranked">N/A</option>
        </select>
    </div>

    <div class="form-group" style="width: 100%;">
        <label for="from-year" style="font-weight: bold; margin-bottom: 5px; display: block;">From Year:</label>
        <input type="number" id="from-year" name="from_year" placeholder="YYYY" min="1900" max="2100" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; width: 100%;">
    </div>

    <div class="form-group" style="width: 100%;">
        <label for="to-year" style="font-weight: bold; margin-bottom: 5px; display: block;">To Year:</label>
        <input type="number" id="to-year" name="to_year" placeholder="YYYY" min="1900" max="2100" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; width: 100%;">
    </div>

    <div class="form-group" style="grid-column: 1 / -1; text-align: center;">
        <button type="submit" class="btn btn-primary" style="padding: 10px 20px; border: none; border-radius: 4px; background-color: #007bff; color: #fff; font-size: 16px; cursor: pointer; width: 200px;">Generate</button>
    </div>
</form>


<div id="graph-container" style="margin-top: 20px;">
    <div class="zoom-buttons">
      <button id="zoom-in-btn">+</button>
      <button id="zoom-out-btn">-</button>
    </div>
    <svg width="fit-content" height="fit-content"></svg>
</div>

<script>
    function filterOptions() {
        const filter = document.getElementById('node-label-filter').value.toLowerCase();
        const options = document.getElementById('node-label').options;
        for (let i = 0; i < options.length; i++) {
            const option = options[i];
            const text = option.textContent.toLowerCase();
            option.style.display = text.includes(filter) ? '' : 'none';
        }
    }

    function sortOptions() {
        const select = document.getElementById('node-label');
        const options = Array.from(select.options);
        options.sort((a, b) => a.text.localeCompare(b.text));
        select.innerHTML = '';
        options.forEach(option => select.appendChild(option));
    }

    document.addEventListener('DOMContentLoaded', () => {
        sortOptions();
    });
</script>






